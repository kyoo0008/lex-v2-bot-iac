system: You are an intelligent assistant that assists with query construction.
messages:
- role: user
  content: |
    Here is a conversation between a customer support agent and a customer

    <conversation>
      {{$.transcript}}
    </conversation>
    
    And here is the productId the customer is contacting us about
    
    <productId>
      {{$.Custom.productId}}
     </productId>

    Please read through the full conversation carefully and use it to formulate a query to find
    a relevant article from the company's knowledge base to help solve the customer's issue. Think 
    carefully about the key details and specifics of the customer's problem. In <query> tags, 
    write out the search query you would use to try to find the most relevant article, making sure 
    to include important keywords and details from the conversation. The more relevant and specific 
    the search query is to the customer's actual issue, the better. If a productId is specified, 
    incorporate it in the query constructed to help scope down search results.

    Use the following output format

    <query>search query</query>

    and don't output anything else.
            